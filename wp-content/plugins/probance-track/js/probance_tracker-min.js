var PROBANCE_browser_detect=null,probance_ajax=null,PROBANCE_encoder=null,PROBANCE_utils=null,PROBANCE_urlUtils=null,PROBANCE_idManager=null;if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")}}if(!String.prototype.endsWith){String.prototype.endsWith=function(a){return this.indexOf(a,this.length-a.length)!==-1}}if(typeof JSON!=="object"){JSON={};function quote(a){escapable.lastIndex=0;return escapable.test(a)?'"'+a.replace(escapable,function(c){var b=meta[c];return typeof b==="string"?b:"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(g,k){var d,b,f,l,c=gap,j,h=k[g];if(h&&typeof h==="object"&&typeof h.toJSON==="function"){h=h.toJSON(g)}if(typeof rep==="function"){h=rep.call(k,g,h)}switch(typeof h){case"string":return quote(h);case"number":return isFinite(h)?String(h):"null";case"boolean":case"null":return String(h);case"object":if(!h){return"null"}gap+=indent;j=[];if(Object.prototype.toString.apply(h)==="[object Array]"){l=h.length;
for(d=0;d<l;d+=1){j[d]=str(d,h)||"null"}f=j.length===0?"[]":gap?"[\n"+gap+j.join(",\n"+gap)+"\n"+c+"]":"["+j.join(",")+"]";gap=c;return f}if(rep&&typeof rep==="object"){l=rep.length;for(d=0;d<l;d+=1){if(typeof rep[d]==="string"){b=rep[d];f=str(b,h);if(f){j.push(quote(b)+(gap?": ":":")+f)}}}}else{for(b in h){if(Object.prototype.hasOwnProperty.call(h,b)){f=str(b,h);if(f){j.push(quote(b)+(gap?": ":":")+f)}}}}f=j.length===0?"{}":gap?"{\n"+gap+j.join(",\n"+gap)+"\n"+c+"}":"{"+j.join(",")+"}";gap=c;return f}}if(typeof JSON.stringify!=="function"){escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};JSON.stringify=function(c,a,d){var b;gap="";indent="";if(typeof d==="number"){for(b=0;b<d;b+=1){indent+=" "}}else{if(typeof d==="string"){indent=d}}rep=a;if(a&&typeof a!=="function"&&(typeof a!=="object"||typeof a.length!=="number")){throw new Error("JSON.stringify")
}return str("",{"":c})}}if(typeof JSON.parse!=="function"){cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i==="object"){for(n in i){if(Object.prototype.hasOwnProperty.call(i,n)){r=walk(i,n);if(r!==undefined){i[n]=r}else{delete i[n]}}}}return reviver.call(e,t,i)}var j;text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}probance_ajax={sendAjax:function(b,a,d,e,g,f,i){var c=null;if(d&&e&&e.trim().length>0){if(a.indexOf("?")==-1){a+="?"+e}else{a+="&"+e}e=""
}if("XDomainRequest" in window&&window.XDomainRequest!==null){c=new XDomainRequest();c.onprogress=function(){};if(f){c.onload=f}if(i){c.onerror=i}c.open((d?"GET":"POST"),a);c.send(e);return}if(window.XMLHttpRequest){c=new XMLHttpRequest()}else{if(window.ActiveXObject){c=new ActiveXObject("Microsoft.XMLHTTP")}}if(c===null){return}c.onload=f;c.onerror=i;if(g){var h=b;c.onreadystatechange=function(){probance_logger.writeDebug(h+" readyState="+this.readyState)}}c.open((d?"GET":"POST"),a,g);if(!d){c.setRequestHeader("Content-type","application/json")}c.send(e)},callScript:function(e,c,a,f){var b=document.createElement("script"),d=null;if(c){b.async=true;b.defer=true}if(b.addEventListener){if(a!==null&&a!==undefined){b.addEventListener("load",function(){a()},false)}if(f!==null&&f!==undefined){b.addEventListener("error",function(){f()},false)}}else{if((a!==null&&a!==undefined)||(f!==null&&f!==undefined)){b.onreadystatechange=function(){var g=b.readyState;if(g==="loaded"){if(g.status==200){if(a!==null&&a!==undefined){a()
}}else{if(f!==null&&f!==undefined){f()}}}}}}b.src=e;d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(b,d)},callImage:function(f,h,a,g){var d=document.createElement("img"),b=null;try{d.style.visibility="hidden"}catch(c){}try{d.style.display="none"}catch(c){}if(d.addEventListener){if(a!==null&&a!==undefined){d.addEventListener("load",function(){a()},false)}if(g!==null&&g!==undefined){d.addEventListener("error",function(){g()},false)}}else{if((a!==null&&a!==undefined)||(g!==null&&g!==undefined)){d.onreadystatechange=function(){var e=d.readyState;if(e==="loaded"){if(e.status==200){if(a!==null&&a!==undefined){a()}}else{if(g!==null&&g!==undefined){g()}}}}}}if(h!==null&&h!==undefined){d.id=h}d.src=f;b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(d,b)}};function probanceCookies(b,a,c){this.name=b;this.delay=a;this.encode=true;if(c!==null&&c!==undefined){if(!c){this.encode=false}else{this.encode=true}}}probanceCookies.prototype.readFromCookie=function(){var b="",a=0,d=0,c="";
b=document.cookie+"";a=b.indexOf(this.name+"=");if(a>=0){a+=this.name.length+1;d=b.indexOf(";",a);if(d<0){d=b.length}if(a===d){return null}c=b.substring(a,d);if(this.encode){c=PROBANCE_encoder.decode(c)}return decodeURIComponent(c)}return null};probanceCookies.prototype.cookieExists=function(){var b="",a=0;b=document.cookie+"";a=b.indexOf(this.name+"=");if(a>=0){return true}return false};probanceCookies.prototype.saveCookie=function(d){var a="",c=null,b="";if(this.delay){c=new Date();c.setTime(c.getTime()+(this.delay*24*60*60*1000));a="; expires="+c.toGMTString()}if(d===null||d===undefined){b=""}b=encodeURIComponent(d);if(this.encode){b=PROBANCE_encoder.encode(b)}document.cookie=this.name+"="+b+a+"; path=/"};probanceCookies.prototype.deleteCookie=function(){document.cookie=this.name+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/"};PROBANCE_browser_detect={alreadyDone:false,init:function(){if(this.alreadyDone){return}this.browser=this.searchString(this.dataBrowser)||"UNKNOWN";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"UNKNOWN";
this.OS=this.searchString(this.dataOS)||"UNKNOWN";this.isMobile=this.isMobile(navigator.userAgent);this.alreadyDone=true},isMobile:function(a){if(a==null){return false}return/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(a)},searchString:function(d){if(d==null){return}var a=0,b=null,c=null;for(a=0;a<d.length;a++){b=d[a].string;c=d[a].prop;this.versionSearchString=d[a].versionSearch||d[a].identity;if(b){if(b.toLowerCase().indexOf(d[a].subString.toLowerCase())!=-1){return d[a].identity}}else{if(c){return d[a].identity}}}},searchVersion:function(b){if(b==null){return}var a=b.toLowerCase().indexOf(this.versionSearchString.toLowerCase());if(a==-1){return}return parseFloat(b.substring(a+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{prop:window.opera,identity:"Opera"},{string:navigator.userAgent,subString:"OmniWeb",identity:"OmniWeb",versionSearch:"OmniWeb/"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.vendor,subString:"Camino",identity:"Camino",versionSearch:"Camino/"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv:"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.userAgent,subString:"IEMobile",identity:"IEMobile"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"iPod",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"iPad",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.userAgent,subString:"BlackBerry",identity:"BlackBerry"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};
PROBANCE_browser_detect.init();PROBANCE_encoder={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){if(c===null||c===undefined||c===""){return""}var a="",k,h,f,j,g,e,d,b=0;c=PROBANCE_encoder._utf8_encode(c);while(b<c.length){k=c.charCodeAt(b++);h=c.charCodeAt(b++);f=c.charCodeAt(b++);j=k>>2;g=((k&3)<<4)|(h>>4);e=((h&15)<<2)|(f>>6);d=f&63;if(isNaN(h)){e=d=64}else{if(isNaN(f)){d=64}}a=a+PROBANCE_encoder._keyStr.charAt(j)+PROBANCE_encoder._keyStr.charAt(g)+PROBANCE_encoder._keyStr.charAt(e)+PROBANCE_encoder._keyStr.charAt(d)}return a},decode:function(c){if(c==null||c===undefined||c==""){return""}var a="",k,h,f,j,g,e,d,b=0;c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(b<c.length){j=PROBANCE_encoder._keyStr.indexOf(c.charAt(b++));g=PROBANCE_encoder._keyStr.indexOf(c.charAt(b++));e=PROBANCE_encoder._keyStr.indexOf(c.charAt(b++));d=PROBANCE_encoder._keyStr.indexOf(c.charAt(b++));k=(j<<2)|(g>>4);h=((g&15)<<4)|(e>>2);f=((e&3)<<6)|d;a=a+String.fromCharCode(k);
if(e!=64){a=a+String.fromCharCode(h)}if(d!=64){a=a+String.fromCharCode(f)}}a=PROBANCE_encoder._utf8_decode(a);return a},_utf8_encode:function(b){if(b===null||b===undefined||b===""){return""}var a="",e=null,d=0;b=b.replace(/\r\n/g,"\n");for(d=0;d<b.length;d++){e=b.charCodeAt(d);if(e<128){a+=String.fromCharCode(e)}else{if((e>127)&&(e<2048)){a+=String.fromCharCode((e>>6)|192);a+=String.fromCharCode((e&63)|128)}else{a+=String.fromCharCode((e>>12)|224);a+=String.fromCharCode(((e>>6)&63)|128);a+=String.fromCharCode((e&63)|128)}}}return a},_utf8_decode:function(a){if(a===null||a===undefined||a===""){return""}var b="",d=0,e=c2=0;while(d<a.length){e=a.charCodeAt(d);if(e<128){b+=String.fromCharCode(e);d++}else{if((e>191)&&(e<224)){c2=a.charCodeAt(d+1);b+=String.fromCharCode(((e&31)<<6)|(c2&63));d+=2}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode(((e&15)<<12)|((c2&63)<<6)|(c3&63));d+=3}}}return b}};PROBANCE_utils={getRandomString:function(){return String((new Date()).getTime()).replace(/\D/gi,"")
},generateId:function(b){if(b<1){b=1}var a=0,c="";for(a=0;a<b;a++){c+="x"}return c.replace(/[x]/g,function(){return Math.floor(Math.random()*10).toString()})},getIndexOfArray:function(c,b){if(c===null||c===undefined){return -1}if(typeof c.indexOf==="function"){return c.indexOf(b)}for(var a=0;a<c.length;a++){if(b===c[a]){return a}}return -1}};PROBANCE_urlUtils={getParams:function(a){var e={},d=null,b=0,c=null;if(a===null||a===undefined||a.indexOf("?")===-1){return e}d=(a.split("?")[1].split("#")[0]).split("&");for(b=0;b<d.length;b++){c=d[b].split("=");e[c[0]]=c[1]}return e},deleteParam:function(c,g){if(c===null||c===undefined||c.indexOf("?")===-1){return c}var a=null,b=null,f=null,d=0,e=0;a=c.split("?")[0];if(c.indexOf("#")>0){b=c.split("#")[1]}f=(c.split("?")[1].split("#")[0]).split("&");e=0;for(d=0;d<f.length;d++){if(f[d].split("=")[0]!=g){if(e==0){a=a+"?"}else{a=a+"&"}a=a+f[d];e++}}if(b!=null&&b.trim().length>0){a+="#"+b}return a},normalize:function(a){if(a===null||a===undefined){return null
}a=a.trim();if(!a.endsWith("/")){a+="/"}return a},getProtocol:function(a){if(a===null||a===undefined){return"http"}var b=a.split(":")[0];if(b===null||b===""){b="http"}return b}};PROBANCE_idManager={getVisitorId:function(a){return a},getCustomerId:function(a){if(a===null||a===undefined){return null}if(a.indexOf("_")==-1){return a}return a.split("_").pop()}};probance_logger={enabled:null,getHourTime:function(c){if(c==null){return""}var f="";var e=c.getHours();var a=c.getMinutes();var d=c.getSeconds();var b=c.getMilliseconds();if(e<10){f+="0"}f+=e+":";if(a<10){f+="0"}f+=a+":";if(d<10){f+="0"}f+=d+".";if(b<=0){f+="000"}else{if(b<10){f+="00"}else{if(b<100){f+="0"}}}f+=b;return f},writeDebug:function(e,a,c){if(!this.enabled||typeof console==="undefined"){return}var d="\t";var b=new Date();var f="";if(a!=null){if(a){d+=" --> start "}else{d+=" <-- end ";if(c!=null){f=" in "+(b.getTime()-c)+" ms"}}}if(console.debug){console.debug(this.getHourTime(b)+d+e+f)}else{if(console.info){console.info(this.getHourTime(b)+d+e+f)
}else{console.log(this.getHourTime(b)+d+e+f)}}},writeLog:function(e,a,c){if(!this.enabled||typeof console==="undefined"){return}var d="\t";var b=new Date();var f="";if(a!=null){if(a){d+=" --> start "}else{d+=" <-- end ";if(c!=null){f=" in "+(b.getTime()-c)+" ms"}}}console.log(this.getHourTime(b)+d+e+f)},writeWarning:function(e,a,c){if(!this.enabled||typeof console==="undefined"){return}var d="\t";var b=new Date();var f="";if(a!=null){if(a){d+=" --> start "}else{d+=" <-- end ";if(c!=null){f=" in "+(b.getTime()-c)+" ms"}}}console.warn(this.getHourTime(b)+d+e+f)},writeError:function(e,a,c){if(!this.enabled||typeof console==="undefined"){return}var d="\t";var b=new Date();var f="";if(a!=null){if(a){d+=" --> start "}else{d+=" <-- end ";if(c!=null){f=" in "+(b.getTime()-c)+" ms"}}}console.error(this.getHourTime(b)+d+e+f)}};function PROBANCE_abstractTracker(c,d,b,a){this.siteid=c;this.cookie=new probanceCookies((d?d:"probance"),b);PROBANCE_browser_detect.init();if(a===undefined||a===null){this.webtraxUrl=null
}else{a=PROBANCE_urlUtils.normalize(a);this.webtraxUrl=PROBANCE_urlUtils.getProtocol(document.location+"")+"://"+a+"listener.action"}this.request="";this.customs=[];this.trackingId=null;this.trackingTypeId=null;this.customerIdentifier=null;this.tagger=null;this.initialized=false;this.trackerType=null;if(this.siteid===undefined){this.siteid=null}this.getTagsAsync=false;this.autoTrackOnInit=true;this.onIdentify=null;this.onTagsLoaded=null;this.probanceDelayedTrack=[]}PROBANCE_abstractTracker.prototype.init=function(b,d){if(this.initialized){return}if(this.siteid===null){this.initialized=true;return}if(this.customerIdentifier===null){this.customerIdentifier=this.getCustomerIdentifier();if(this.customerIdentifier===null){this.initialized=true;return}}var c=this.getUrl();this.customerIdentifier.init(b,this,c);if("getUrl" in this.customerIdentifier){c=this.customerIdentifier.getUrl(c)}if(this.autoTrackOnInit){this.probanceDelayedTrack.push(new probanceDelayedTrackItem(c,false,null))}var a=this;
setTimeout(function(){a.executeDelayedTrack()},4);if(this.tagger!=null&&!this.customerIdentifier.isNew()&&this.trackingId!=null){this.tagger.taggerType=this.trackerType;this.tagger.useAsyncCall=this.getTagsAsync;this.tagger.init(this.trackingId,this.trackingTypeId,function(){if(d){setTimeout(function(){d()},100)}setTimeout(function(){a.executeDelayedTrack()},4)})}else{if(d){setTimeout(function(){d()},100)}setTimeout(function(){a.executeDelayedTrack()},4)}};PROBANCE_abstractTracker.prototype.afterIdentify=function(){if(this.onIdentify!=null&&this.trackingId!=null){this.onIdentify(this.trackingId,this.trackingTypeId)}if(this.customerIdentifier!=null&&!this.customerIdentifier.isNew()){if(this.tagger!=null){if(!this.tagger.loaded){this.tagger.useAsyncCall=this.getTagsAsync;this.tagger.init(this.trackingId,this.trackingTypeId,this.onTagsLoaded)}}}};PROBANCE_abstractTracker.prototype.initTagger=function(c,b,a){this.tagger=new PROBANCE_taggerValue(this.trackerType,this.siteid,c,b,a);this.tagger.useAsyncCall=this.getTagsAsync
};PROBANCE_abstractTracker.prototype.getTag=function(b,a){if(b===null){return null}if(this.tagger===null){return null}return this.tagger.getTag(b,a)};PROBANCE_abstractTracker.prototype.getTags=function(){if(this.tagger===null){return null}return this.tagger.getTags()};PROBANCE_abstractTracker.prototype.printTags=function(d){if(this.tagger===null||this.tagger.getTags()===null){return""}var a=this.tagger.getTags(),c="",e=true;for(var b=0;b<a.tags.length;b++){if(a.tags[b]!==null){if(!e){c+=d}e=false;c+=encodeURIComponent(a.tags[b].name)+"="+encodeURIComponent(a.tags[b].value)}}return c};PROBANCE_abstractTracker.prototype.getTagsTime=function(){if(this.tagger===null){return null}return this.tagger.getTagsTime()};PROBANCE_abstractTracker.prototype.isTagsLoad=function(){if(this.tagger===null){return false}return this.tagger.loaded};PROBANCE_abstractTracker.prototype.addCustom=function(a,b){this.customs.push([a,b])};PROBANCE_abstractTracker.prototype.clearCustom=function(a,b){this.customs=[]};
PROBANCE_abstractTracker.prototype.readTrackingInfo=function(){var a=this.cookie.readFromCookie();if(a!==null&&a!==undefined){tracking_part=a.split("\n");if(tracking_part.length>0){this.trackingId=tracking_part[0];if(tracking_part.length>=1){this.trackingTypeId=tracking_part[1]}}}};PROBANCE_abstractTracker.prototype.getTrackingId=function(){var a=null;if(this.trackingId!==null){return this.trackingId}if(this.cookie===null||this.cookie===undefined){return null}a=this.readTrackingInfo();return this.trackingId};PROBANCE_abstractTracker.prototype.getTrackingTypeId=function(){var a=null;if(this.trackingTypeId!==null){return this.trackingTypeId}if(this.cookie===null||this.cookie===undefined){return null}a=this.readTrackingInfo();return this.trackingTypeId};PROBANCE_abstractTracker.prototype.getCustomerIdentifier=function(){return this.customerIdentifier};PROBANCE_abstractTracker.prototype.getUrl=function(){return document.location+""};PROBANCE_abstractTracker.prototype.getReferrer=function(){return document.referrer+""
};function probanceDelayedTrackItem(a,c,b){this.url=a;this.isEvent=c;this.custAttr=b}PROBANCE_abstractTracker.prototype.executeDelayedTrack=function(){if(this.siteid===null){return}if(!this.initialized){return}if(this.probanceDelayedTrack==null){return}var a=null;while(this.probanceDelayedTrack.length>0){a=this.probanceDelayedTrack.pop();if(a==null){continue}if(a.isEvent){this.trackEvent(a.url,a.custAttr)}else{this.track(a.url,a.custAttr)}}};PROBANCE_abstractTracker.prototype._getTrackRequest=function(a,l,j){if(this.siteid===null){return null}if(!this.initialized){this.probanceDelayedTrack.push(new probanceDelayedTrackItem(a,l,j));return null}var f=null,c="",d="",b=[],k=[],h=null,g=null,e=0;if(this.customerIdentifier===null){this.customerIdentifier=this.getCustomerIdentifier();if(this.customerIdentifier===null){return null}}f=this.customerIdentifier.getTrackingMode();if(this.trackingId===null||this.trackingId===undefined){return null}if(a===null||a===undefined){a=this.getUrl();if("getUrl" in this.customerIdentifier){a=this.customerIdentifier.getUrl(a)
}}c="";if(j!==null&&j!==undefined&&j.length>0){for(e=0;e<j.length;e++){h=encodeURIComponent(j[e][0]);g=encodeURIComponent(j[e][1]);if(h==null){continue}if(PROBANCE_utils.getIndexOfArray(k,h)!=-1){continue}k.push(h);if(g!=null){b.push(h+"="+g)}else{b.push(h+"=")}}}if(this.customs!==null&&this.customs!==undefined&&this.customs.length>0){for(e=0;e<this.customs.length;e++){h=encodeURIComponent(this.customs[e][0]);g=encodeURIComponent(this.customs[e][1]);if(h==null){continue}if(PROBANCE_utils.getIndexOfArray(k,h)!=-1){continue}k.push(h);if(g!=null){b.push(h+"="+g)}else{b.push(h+"=")}}}if(b!=null&&b.length>0){c=b.join("&")}var d=this.webtraxUrl+"?";if(this.trackingTypeId!=null&&this.trackingTypeId!=undefined&&this.trackingTypeId.trim().length>0){d+="typeId="+encodeURIComponent(this.trackingTypeId)+"&"}d+="id="+encodeURIComponent(this.trackingId)+"&"+"purl="+encodeURIComponent(PROBANCE_encoder.encode(a))+"&"+"site="+encodeURIComponent(this.siteid)+"&"+"os="+encodeURIComponent(PROBANCE_browser_detect.OS)+"&"+"br="+encodeURIComponent(PROBANCE_browser_detect.browser)+"&"+"ver="+encodeURIComponent(PROBANCE_browser_detect.version)+"&"+"mod="+encodeURIComponent(f)+"&"+"customParams="+encodeURIComponent(c)+"&"+"referrer="+encodeURIComponent(PROBANCE_encoder.encode(this.getReferrer()))+"&"+"version="+encodeURIComponent(PROBANCE_infos.version)+"&";
if(l!=null&&l!=undefined&&l){d+="event=1&"}if(probance_logger.enabled){probance_logger.writeLog("tracker "+(this.trackerType!=null?"["+this.trackerType+"] ":"")+(l!=null&&l!=undefined&&l?"event ":"visit ")+"for '"+this.trackingId+"' "+"on url '"+a+"' "+"with customParams : '"+c+"'")}return d};PROBANCE_abstractTracker.prototype.track=function(a,b){var c=this._getTrackRequest(a,false,b);if(c!=null){probance_ajax.callImage(c)}};PROBANCE_abstractTracker.prototype.trackEvent=function(a,b){var c=this._getTrackRequest(a,true,b);if(c!=null){probance_ajax.callImage(c)}};function PROBANCE_CRM_trackingMode(a){this.tracking_param=a;this.tracking_mode=1}var cookieSep="\ntype=";PROBANCE_CRM_trackingMode.prototype.init=function(g,f,c){var h=null,e=null,b=null,a=null,d=null;f.trackingId=null;h=PROBANCE_urlUtils.getParams(c);e=h[this.tracking_param];if(e!==null&&e!==undefined){f.cookie.saveCookie(e);this.tracking_mode=0;f.trackingId=e;if(f.afterIdentify!=null){f.afterIdentify()}}else{e=f.cookie.readFromCookie();
if(e!==null&&e!==undefined){b=e.split(cookieSep);if(b.length>0){a=b[0];if(b.length>=1){d=b[1]}}}if(a!==null&&a!==undefined){f.trackingId=a;if(d!==null&&d!==undefined&&d.trim().length>0){f.trackingTypeId=d.trim()}else{f.trackingTypeId=null}if(f.afterIdentify!=null){f.afterIdentify()}e=f.trackingId;if(f.trackingTypeId!=null){e+=cookieSep+f.trackingTypeId}f.cookie.saveCookie(e)}}f.initialized=true};PROBANCE_CRM_trackingMode.prototype.getTrackingMode=function(){return this.tracking_mode};PROBANCE_CRM_trackingMode.prototype.getUrl=function(a){return PROBANCE_urlUtils.deleteParam(a,this.tracking_param)};PROBANCE_CRM_trackingMode.prototype.isNew=function(){return false};var PROBANCE_CRMTracker=(function(g,h,d,b,a,f,c){var e=function(n,o,l,j,i,m,k){PROBANCE_abstractTracker.call(this,n,o,l,j);this.trackerType="CRM";this.customerIdentifier=new PROBANCE_CRM_trackingMode(i);if(m!==null&&m!==undefined){this.initTagger(m,PROBANCE_idManager.getCustomerId,k)}};e.prototype=new PROBANCE_abstractTracker(g,h,d,b);
e.prototype.constructor=e;e.prototype.track=function(i,j){PROBANCE_abstractTracker.prototype.track.call(this,i,j)};e.prototype.setCustomer=function(j,i){var k=null;if(this.trackingId!==j||this.trackingTypeId!==i){if(this.tagger!=null){this.tagger.clear()}}this.trackingId=j;if(i!==null&&i!==undefined){this.trackingTypeId=i}if(this.afterIdentify!=null){this.afterIdentify()}k=this.trackingId;if(this.trackingTypeId!=null){k+=cookieSep+this.trackingTypeId}this.cookie.saveCookie(k)};return e}());function PROBANCE_VRM_trackingMode(b,a){this.isNewVisitor=false;if(b.trim().length>0){b=PROBANCE_urlUtils.normalize(b);this.probanceGenerator=PROBANCE_urlUtils.getProtocol(document.location+"")+"://"+b+"VisitorIdGenerator";this.probanceIdentifier=PROBANCE_urlUtils.getProtocol(document.location+"")+"://"+b+"Identifier"}this.visitorCreationCallback=a;this.createdVisitorSentToTagger=false}PROBANCE_VRM_trackingMode.prototype.init=function(i,h){var e=null,d=null,a=null,f=null,g=0,j=this,c=null;if(h.trackingId===null||h.trackingId===undefined){h.trackingId=h.cookie.readFromCookie();
if(!this.isVisitorIdValid(h.trackingId)){h.trackingId=null}}if(h.trackingId!==null){h.initialized=true;this.isNewVisitor=false;probance_logger.writeLog("tracker VRM: read visitor id");h.cookie.saveCookie(h.trackingId);if(h.afterIdentify!=null){h.afterIdentify()}probance_ajax.callScript(this.probanceGenerator+"/"+h.trackingId,true,null,null);return}if("origin" in document.location&&document.location.origin!==undefined&&document.location.origin!==null){c=document.location.origin}else{c=document.location.protocol+"//"+document.domain}probance_logger.writeLog("tracker VRM: get visitor id from Probance");var b=function(o){h.initialized=true;var l=false,n=null,k=null;if(o===undefined||o===null){return null}n=o.split("_");if(n.length>0){o=n[0];if(n.length>=1){k=n[1]}if(k!=null&&((new Date()).getTime()-(0+k))<1000){l=true}}if(!j.isVisitorIdValid(o)){probance_logger.writeWarning("received visitorId is not valid, ignore");return null}j.isNewVisitor=l;h.trackingId=o;h.cookie.saveCookie(o);if(h.afterIdentify!=null){h.afterIdentify()
}if(h.autoTrackOnInit){h.track()}if(l&&!j.createdVisitorSentToTagger){probance_logger.writeLog("tracker VRM: get '"+o+"' visitor id from Probance");if(h.tagger){probance_logger.writeLog("send created VRM visitor '"+o+"' to tagger");try{probance_ajax.sendAjax("tagger "+(h.taggerType!==null?"["+h.tagger.taggerType+"] ":""),h.tagger.taggerVisitorCreatorUrl+o,false,"",true,function(){j.createdVisitorSentToTagger=true})}catch(m){probance_logger.writeWarning("error sending created VRM visitor '"+o+"' to tagger\n"+m)}}else{probance_logger.writeLog("tagger is disabled, could not sent created VRM visitor")}if(j.visitorCreationCallback!=null){try{j.visitorCreationCallback(o)}catch(m){probance_logger.writeWarning("tracker VRM: fail to sent created visitor\n"+m)}}}return o};probance_ajax.callScript(this.probanceIdentifier,true,function(){if(generatedProbanceVisitorId==null){var k=1*PROBANCE_utils.generateId(12);probance_logger.writeWarning("tracker VRM: fail to get visitor id from Probance, generate one: '"+k+"'");
b(""+k);return}probance_logger.writeLog("tracker VRM: get visitor id from Probance: '"+generatedProbanceVisitorId+"'");var k=b(""+generatedProbanceVisitorId);if(k!=null){probance_ajax.callScript(j.probanceGenerator+"/"+k,true,null,null)}return},function(){var k=1*PROBANCE_utils.generateId(12);probance_logger.writeWarning("tracker VRM: fail to get visitor id from Probance, generate one: '"+k+"'");b(""+k)})};PROBANCE_VRM_trackingMode.prototype.isVisitorIdValid=function(a){if(a==null||a==undefined){return false}if(a.trim().length==0){return false}if(isNaN){return !isNaN(a)}if(Object.prototype.toString.call(a)!="[object String]"){return false}return true};PROBANCE_VRM_trackingMode.prototype.getTrackingMode=function(){return 1};PROBANCE_VRM_trackingMode.prototype.isNew=function(){return this.isNewVisitor};var PROBANCE_VRMTracker=(function(g,h,d,a,b,f,c){var e=function(n,o,l,i,j,m,k){PROBANCE_abstractTracker.call(this,n,o,l,i);this.trackerType="VRM";this.visitorCreationCallback=j;this.customerIdentifier=new PROBANCE_VRM_trackingMode(i,j);
if(m!==null&&m!==undefined){this.initTagger(m,PROBANCE_idManager.getVisitorId,k)}};e.prototype=new PROBANCE_abstractTracker(g,h,d,a);e.prototype.constructor=e;e.prototype.track=function(i,j){PROBANCE_abstractTracker.prototype.track.call(this,i,j)};return e}());function PROBANCE_tags(){this.trackingId=null;this.trackingTypeId=null;this.generationDate=null;this.nextVerification=null;this.tags=new Array()}PROBANCE_tags.prototype.addTag=function(a,b,d,c){if(d===null||d===undefined){d=c}if(c!==null&&c!==undefined){if(b=="d"||b=="t"){c=new Date(c)}}this.tags.push(new PROBANCE_tag(a,b,d,c))};PROBANCE_tags.prototype.exportAsJson=function(){if(this.tags===null){return""}var b=null,c=null,a=0;for(a=0;a<this.tags.length;a++){if(this.tags[a]==null){continue}c=JSON.stringify(this.tags[a],["name","type","rawValue"]);if(b==null){b=c}else{b+=", "+c}}if(b==null){return'{"tags":[]}'}return'{"tags":['+b+"]}"};PROBANCE_tags.prototype.getTagValue=function(a){var b=0;for(b=0;b<this.tags.length;b++){if(this.tags[b].name==a){return this.tags[b].value
}}return null};PROBANCE_tags.prototype.readFromString=function(c){if(!c){return null}var d=null,b=0,a=null;d=JSON.parse(c);if(!d){return null}a=new PROBANCE_tags();a.generationDate=new Date(d.generationDate);a.nextVerification=new Date(d.nextVerification);a.trackingId=d.trackingId;for(b=0;b<d.tags.length;b++){a.addTag(d.tags[b].name,d.tags[b].type,d.tags[b].rawValue,d.tags[b].value)}return a};function PROBANCE_tag(a,b,d,c){this.name=a;this.type=b;this.rawValue=d;this.value=c}function PROBANCE_taggerValue(e,d,c,b,a){this.siteId=d;this.taggerGetTagsUrl=null;this.taggerImportTagsUrl=null;this.taggerVisitorCreatorUrl=null;if(c.trim().length>0){c=PROBANCE_urlUtils.normalize(c);this.taggerGetTagsUrl=PROBANCE_urlUtils.getProtocol(document.location+"")+"://"+c+"api/tags/"+d+"/";this.taggerImportTagsUrl=PROBANCE_urlUtils.getProtocol(document.location+"")+"://"+c+"api/importTags/"+d+"/";this.taggerVisitorCreatorUrl=PROBANCE_urlUtils.getProtocol(document.location+"")+"://"+c+"api/visitor/"+d+"/"}this.storagePrefixName=a;
this.storageName=null;this.idFunction=b;this.taggerType=e;this.loaded=false;this.tagValue=null;this.callbackAfterLoad=null;this.useAsyncCall=false;this.tagsChanged=false;this.initialized=false}PROBANCE_taggerValue.prototype.clear=function(){this.loaded=false;this.tagValue=null;this.initialized=false};PROBANCE_taggerValue.prototype.getTagsTime=function(){if(this.tagValue!==null){return this.tagValue.expires}return null};PROBANCE_taggerValue.prototype.getLocalTags=function(){try{if(!localStorage){return null}}catch(b){return null}var a=localStorage.getItem(this.storageName);return PROBANCE_encoder.decode(a)};PROBANCE_taggerValue.prototype.removeLocalTags=function(){try{if(!localStorage){return}localStorage.removeItem(this.storageName)}catch(a){return null}};PROBANCE_taggerValue.prototype.saveLocalTags=function(a){try{if(!localStorage){return}localStorage.setItem(this.storageName,a)}catch(b){return null}};PROBANCE_taggerValue.prototype.init=function(c,e,h){if(this.initialized){if(h!=null){h()
}return}this.initialized=true;if(this.storageName==null){if(this.storagePrefixName!=null&&this.storagePrefixName!=undefined){this.storageName=this.storagePrefixName+"_"}else{this.storageName=""}this.storageName+=this.taggerType+"_tags"}if(c===null){this.tagValue=null;if(h!=null){h()}return}if(this.tagValue!==null){if(h!=null){h()}return}if(e!==null&&e!==undefined&&e.trim().length>0){e=e.trim()}else{e=null}var f=null,d=null,b=null,g="tagger "+(this.taggerType!==null?"["+this.taggerType+"] ":"");f=this.getLocalTags();if(f!==null){this.tagValue=new PROBANCE_tags().readFromString(f);if(this.tagValue!=null){if(this.tagValue.trackingId!==c||this.tagValue.trackingTypeId!==e){probance_logger.writeLog(g+"local tags are not for this customer");this.removeLocalTags();this.tagValue=null}}else{if(this.tagValue!=null){this.removeLocalTags();this.tagValue=null}}}d=this;if(this.tagValue!==null){if(this.tagValue.nextVerification&&this.tagValue.nextVerification.getTime()>new Date().getTime()){this.loaded=true;
if(h!=null){h()}return}}probance_logger.writeLog(g+"get tags from server",true);var a=new Date();b=null;if(d.idFunction!==null&&e==null){b=d.idFunction(c)}if(b===null){b=c}d.getTagsFromServer(g+"get tags from server",b,e,d.useAsyncCall,function(j){probance_logger.writeLog(g+"get tags from server",false,a);var i="";if(d.tagValue!==null){d.tagValue.trackingId=b;d.tagValue.trackingTypeId=e;i=JSON.stringify(d.tagValue)}d.saveLocalTags(PROBANCE_encoder.encode(i));probance_logger.writeLog(g+"save tag into local storage");if(h){h()}d.tagsChanged=j;if(j&&d.callbackAfterLoad){setTimeout(d.callbackAfterLoad,100)}})};PROBANCE_taggerValue.prototype.getTags=function(){return this.tagValue};PROBANCE_taggerValue.prototype.getTag=function(c,a){if(c===null){return null}var b=null,d=null;b=this.getTags();if(b==null){return a}d=b.getTagValue(c);if(d==null){return a}return d};PROBANCE_taggerValue.prototype.getTagsFromServer=function(h,f,d,e,g){var b=this;var a=(this.tagValue&&this.tagValue.nextVerification?"ifModifiedSince="+this.tagValue.nextVerification.getTime():"");
if(d!==null&&d!==undefined&&d.trim().length>0){d=d.trim()}else{d=null}var c=this.taggerGetTagsUrl;if(d!==null){c+=d+"/"}c+=f;probance_ajax.sendAjax(h,c,true,a,e,function(){var m=null,q=null,o=null,j=null,s=null,l=null,r=null,p=0,n=false;if(!b.tagValue){b.tagValue=new PROBANCE_tags()}if("status" in this&&this.status!==undefined&&this.status!==null){m=Math.floor(this.status/100);if(m===2){q=this.responseText}}else{if("XDomainRequest" in window&&window.XDomainRequest!==null){q=this.responseText}}if(q===null){probance_logger.writeWarning(h+": not content (http "+this.status+")")}else{if(this.responseText.trim().length==0){probance_logger.writeLog(h+": unchanged")}else{try{o=JSON.parse(q)}catch(k){probance_logger.writeWarning(h+": fail to parse"+q)}if(o!==null){if("tags" in o&&o.tags){probance_logger.writeLog(h+": changed");n=true;b.tagValue=new PROBANCE_tags();b.tagValue.trackingId=f;b.tagValue.trackingTypeId=d;b.tagValue.generationDate=new Date(o.generationDate);for(p=0;p<o.tags.length;p++){l=null;
j=o.tags[p].name;r=o.tags[p].type;s=o.tags[p].value;if(o.tags[p].hasOwnProperty("rawValue")){l=o.tags[p].rawValue}b.tagValue.addTag(j,r,l,s)}}else{probance_logger.writeLog(h+": empty tags")}if("expires" in o){b.tagValue.nextVerification=new Date(o.expires)}}}}b.loaded=true;if(g){g(n)}return},function(){b.tagValue=null;if(g){g(false)}return})};function PROBANCE_trackers(){this.initialized=false;this.getTagsAsync=false;this.crmTagsSentToVRM=false;this.autoTrackOnInit=true;this.trackerCRM=null;this.trackerVRM=null}PROBANCE_trackers.prototype.doNotTrackOnInit=function(){this.autoTrackOnInit=false};PROBANCE_trackers.prototype.setCRM=function(a){this.trackerCRM=a};PROBANCE_trackers.prototype.setVRM=function(a){this.trackerVRM=a};PROBANCE_trackers.prototype.sendCRMTags=function(){if(this.crmTagsSentToVRM){return true}if(this.trackerCRM===null||this.trackerCRM.tagger===null||this.trackerVRM===null||this.trackerVRM.tagger===null){return false}if(this.trackerCRM.getTags()===null||this.trackerCRM.getTags().tags===null||this.trackerCRM.getTags().tags.length==0){return false
}var b=this.trackerCRM.getTags().exportAsJson();var c=this.trackerVRM.getTrackingId();var a=this;probance_logger.writeLog("send CRM tags to VRM with\n"+b);probance_ajax.sendAjax("tagger "+(this.trackerVRM.tagger.taggerType!==null?"["+this.trackerVRM.tagger.taggerType+"] ":""),this.trackerVRM.tagger.taggerImportTagsUrl+c,false,b,true,function(){a.crmTagsSentToVRM=true});return true};PROBANCE_trackers.prototype.init=function(g){var h=this,d=null,e=null,c=0,j=null,b=null,f=[];if(this.initialized){return}d=this.trackerCRM;e=this.trackerVRM;if(d!==null&&d!==undefined&&d.tagger!==null&&d.tagger!==undefined&&e!==null&&e!==undefined&&e.tagger!==null&&e.tagger!==undefined){e.tagger.callbackAfterLoad=function(){h.sendCRMTags()}}if(d){f.push(d)}if(e){f.push(e)}var a=function a(m,k,l){if(!k){return}var i=k;probance_logger.writeLog("start init "+k.trackerType);k.init(m,function(){m.initialized=true;probance_logger.writeLog("end init callback "+i.trackerType);if(l===null||l===undefined){return}if(f!=null){var n=PROBANCE_utils.getIndexOfArray(f,i);
if(n!=-1){f.splice(n,1)}}if(f==null||f.length==0){if(l){l()}}});probance_logger.writeLog("end init "+k.trackerType)};if(this.trackerCRM){this.trackerCRM.getTagsAsync=this.getTagsAsync;this.trackerCRM.autoTrackOnInit=this.autoTrackOnInit;setTimeout(function(){a(h,d,g)},4)}if(this.trackerVRM){this.trackerVRM.getTagsAsync=this.getTagsAsync;this.trackerVRM.autoTrackOnInit=this.autoTrackOnInit;setTimeout(function(){a(h,e,g)},4)}};PROBANCE_trackers.prototype.track=function(a,b){if(this.trackerCRM){this.trackerCRM.track(a,b)}if(this.trackerVRM){this.trackerVRM.track(a,b)}};PROBANCE_trackers.prototype.trackEvent=function(a,b){if(this.trackerCRM){this.trackerCRM.trackEvent(a,b)}if(this.trackerVRM){this.trackerVRM.trackEvent(a,b)}};PROBANCE_trackers.prototype._getTag=function(c,b,a){if(!c){return null}return c.getTag(b,a)};PROBANCE_trackers.prototype._getId=function(a){if(!a){return null}return a.getTrackingId()};PROBANCE_trackers.prototype._getTags=function(a){if(!a){return null}return a.getTags()
};PROBANCE_trackers.prototype._printTags=function(a,b){if(!a){return null}return a.printTags(b)};PROBANCE_trackers.prototype._getTagsTime=function(a){if(!a){return null}return a.getTagsTime()};PROBANCE_trackers.prototype._isTagsLoad=function(a){if(!a){return true}return a.isTagsLoad()};PROBANCE_trackers.prototype._addCustom=function(b,a,c){if(!b){return}b.addCustom(a,c)};PROBANCE_trackers.prototype._clearCustom=function(a){if(!a){return}a.clearCustom()};PROBANCE_trackers.prototype.getCRMTag=function(b,a){return this._getTag(this.trackerCRM,b,a)};PROBANCE_trackers.prototype.getVRMTag=function(b,a){return this._getTag(this.trackerVRM,b,a)};PROBANCE_trackers.prototype.getCRMTags=function(){return this._getTags(this.trackerCRM)};PROBANCE_trackers.prototype.getVRMTags=function(){return this._getTags(this.trackerVRM)};PROBANCE_trackers.prototype.printCRMTags=function(a){return this._printTags(this.trackerCRM,a)};PROBANCE_trackers.prototype.printVRMTags=function(a){return this._printTags(this.trackerVRM,a)
};PROBANCE_trackers.prototype.getCRMTagsTime=function(){return this._getTagsTime(this.trackerCRM)};PROBANCE_trackers.prototype.getVRMTagsTime=function(){return this._getTagsTime(this.trackerVRM)};PROBANCE_trackers.prototype.isTagsCRMLoad=function(){return this._isTagsLoad(this.trackerCRM)};PROBANCE_trackers.prototype.isTagsVRMLoad=function(){return this._isTagsLoad(this.trackerVRM)};PROBANCE_trackers.prototype.clearCustom=function(a,b){this._clearCustom(this.trackerCRM);this._clearCustom(this.trackerVRM)};PROBANCE_trackers.prototype.addCustom=function(a,b){this._addCustom(this.trackerCRM,a,b);this._addCustom(this.trackerVRM,a,b)};PROBANCE_trackers.prototype.addCustomCRM=function(a,b){this._addCustom(this.trackerCRM,a,b)};PROBANCE_trackers.prototype.addCustomVRM=function(a,b){this._addCustom(this.trackerVRM,a,b)};PROBANCE_trackers.prototype.clearCustomCRM=function(){this._clearCustom(this.trackerCRM)};PROBANCE_trackers.prototype.clearCustomVRM=function(){this._clearCustom(this.trackerVRM)
};PROBANCE_trackers.prototype.getCRMId=function(){return this._getId(this.trackerCRM)};PROBANCE_trackers.prototype.getVRMId=function(){return this._getId(this.trackerVRM)};PROBANCE_infos={version:"3.2.8#1125"};